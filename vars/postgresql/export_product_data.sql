SELECT sku, NULL AS list_price, discontinued, business_unit FROM product_list WHERE discontinued = '1' AND updated_date >= NOW() - INTERVAL '{0} HOURS' UNION SELECT pl.sku, (CASE WHEN {1} THEN lp.list_price END) AS list_price, pl.discontinued, pl.business_unit FROM product_list AS pl INNER JOIN list_price AS lp ON lp.sku = pl.sku WHERE pl.discontinued = '0' AND (CASE WHEN {1} THEN lp.updated_date::TIMESTAMP::DATE = CURRENT_DATE ELSE pl.updated_date >= NOW() - INTERVAL '{0} HOURS' END) UNION SELECT pl.sku, lp.list_price, pl.discontinued, pl.business_unit FROM product_list AS pl INNER JOIN list_price AS lp ON lp.sku = pl.sku WHERE {1} AND lp.effective_date::TIMESTAMP::DATE = CURRENT_DATE + 1